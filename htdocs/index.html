<!DOCTYPE html>
<html>
    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
        <link class="include" rel="stylesheet" type="text/css" href="./jqplot/jquery.jqplot.min.css" />
        <link class="include" rel="stylesheet" type="text/css" href="./jquery/mobile/datepicker-theme.css" />
        
        <script class="include" type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script class="include" type="text/javascript" src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
        <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js"></script>
        <script type="text/javascript" src="./jquery/mobile/datepicker-wrapper.js"></script>
        <script type="text/javascript" src="./jqplot/jquery.jqplot.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.pointLabels.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.categoryAxisRenderer.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.canvasTextRenderer.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.dateAxisRenderer.min.js"></script>
        <script type="text/javascript" src="./jqplot/plugins/jqplot.highlighter.min.js"></script>
    </head>
    <body>        
        <div data-role="page">
            <div data-role="header">
                <h1>Biorhytms</h1>                
            </div><!-- /header -->

                <div data-role="tabs" id="tabs">
                    <div data-role="navbar">
                        <ul>
                            <li><a href="#biorhytms-data" data-ajax="false" class="ui-btn-active">Data</a></li>
                            <li><a id="show-chart-toggler" href="#biorhytms-chart" data-ajax="false">Chart</a></li>
                        </ul>
                    </div>
                    <div id="biorhytms-data" class="ui-content">
                        <input type="text" id="date-input" data-inline="false" data-role="date" placeholder="Enter birthdate">                
                    </div>
                    <div id="biorhytms-chart" class="ui-content">
                        <div id="chart1" style="margin:0 20px 0 0; height: 300px;"></div>
                    </div>
                </div>
                
            <div data-role="footer">
                <h4>&nbsp;</h4>
            </div><!-- /footer -->
        </div><!--page-->
        
        <script type="text/javascript">
            $(document).on('click', '#show-chart-toggler', function() {
                var now = moment(),
                    birthDay = moment("1971-06-25"),
                    diff = now.diff(birthDay, 'days'),
                    physical = [],
                    emotional = [],
                    intellectual = [],
                    currentDay = birthDay.clone(),
                    currentDayAsString = currentDay.format('YYYY-MM-DD'),
                    currentDiffInDays = 0;
                    
                for (var i = 1; i < 26; i++) {
                    physical.push([currentDayAsString, Math.sin(2 * Math.PI * currentDiffInDays / 23)]);
                    emotional.push([currentDayAsString, Math.sin(2 * Math.PI * currentDiffInDays / 28)]);
                    intellectual.push([currentDayAsString, Math.sin(2 * Math.PI * currentDiffInDays / 33)]);
                    
                    currentDiffInDays++;
                    currentDay.add(1, 'day');
                    currentDayAsString = currentDay.format('YYYY-MM-DD')
                }
                    
                var plot1 = $.jqplot('chart1', [physical, emotional, intellectual], {
                    // Turns on animation for all series in this plot.
                    animate : true,
                    axesDefaults : {						
                        pad : 0,       // a factor multiplied by the data range on the axis to give the
                                        // axis range so that data points don't fall on the edges of the axis.
                        tickOptions : {
                            showMark : false     // whether or not to show the mark on the axis							
                        }
                    },
                    
                    axes : {
                        xaxis : {
                            show : true,                                
                            drawMajorGridlines : false,
                            renderer : $.jqplot.DateAxisRenderer,
                            tickRenderer : $.jqplot.CanvasAxisTickRenderer,
                            tickOptions : {
                                showMark : true,
                                markSize : 10,
                                labelPosition : 'middle',
                                angle : -45
                            }
                        },
                        
                        yaxis : {
                            pad : 1.1,
                            drawMajorGridlines : true
                        }
                    },
                    
                    seriesDefaults : {
                        shadow : false			
                    },
                    
                    grid : {
                        background : '#fff',      // CSS color spec for background color of grid.
                        borderWidth : 0,           // pixel width of border around grid.
                        shadow : false               // draw a shadow for grid.						
                    },
                    
                    highlighter : {
                        show : true,
                        sizeAdjust : 3,          // pixels to add to the size of filled markers when drawing highlight.
                        showTooltip : true,      // show a tooltip with data point values.
                        tooltipLocation : 'nw',  // location of tooltip : n, ne, e, se, s, sw, w, nw.
                        fadeTooltip : true,      // use fade effect to show/hide tooltip.
                        tooltipFadeSpeed : 'def', // slow, def, fast, or a number of milliseconds.
                        tooltipOffset : 2,       // pixel offset of tooltip from the highlight.
                        tooltipAxes : 'y',        // which axis values to display in the tooltip, x, y or both.
                        useAxesFormatters : false, // use the same format string and formatters as used in the axes to
                                                // display values in the tooltip.
                        tooltipFormatString : '&nbsp;%.3f &nbsp;' // sprintf format string for the tooltip.  only used if
                                                    // useAxesFormatters is false.  Will use sprintf formatter with
                                                    // this string, not the axes formatters.
            
                    }
                });
            });
            
        </script>

    </body>

</html>

